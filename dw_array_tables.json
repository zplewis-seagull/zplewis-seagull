[
    {
      "source": { "table": "dates_by_business_unit_view" },
      "destination": { "table": "Business Days" },
      "copySource": {
        "sqlReaderQuery": "select * from [dbo].[dates_by_business_unit_view] WHERE [dbo].[dates_by_business_unit_view].[business_unit_id] NOT IN (5,6,7)"
      }
    },
    {
      "source": { "schema": "dbo", "table": "Account" },
      "destination": { "table": "Account" }
    },
    {
      "source": { "schema": "dbo", "table": "Activation Method" },
      "destination": { "table": "Activation Method" }
    },
    {
      "source": { "schema": "dbo", "table": "Bartender Bugs" },
      "destination": { "table": "Bartender Bugs" }
    },
    {
      "source": { "schema": "dbo", "table": "Bill To Geography" },
      "destination": { "table": "Bill To Geography" }
    },
    {
      "source": { "schema": "dbo", "table": "Bonus Commission Targets" },
      "destination": { "table": "Bonus Commission Targets" }
    },
    {
      "source": { "schema": "dbo", "table": "Bonus Sales Targets" },
      "destination": { "table": "Bonus Sales Targets" }
    },
    {
      "source": { "schema": "dbo", "table": "Bonus Transactions" },
      "destination": { "table": "Bonus Transactions" }
    },
    {
      "source": { "schema": "dbo", "table": "Budget" },
      "destination": { "table": "Budget" }
    },
    {
      "source": { "schema": "dbo", "table": "Version" },
      "destination": { "table": "Version" }
    },
    {
      "source": { "schema": "opportunity", "table": "actual_close_date" },
      "destination": { "table": "actual_close_date" }
    },
    {
      "source": { "schema": "ticket", "table": "Assignee" },
      "destination": { "table": "Assignee" }
    },
    {
      "source": { "schema": "dbo", "table": "Budget and Actuals Currency Rate" },
      "destination": { "table": "Budget and Actuals Currency Rate" }
    },
    {
      "source": { "schema": "dbo", "table": "Budget Version" },
      "destination": { "table": "Budget Version" }
    },
    {
      "source": { "schema": "dbo", "table": "Bug Customer Impact" },
      "destination": { "table": "Bug Customer Impact" }
    },
    {
      "source": { "schema": "dbo", "table": "Bug Resolution" },
      "destination": { "table": "Bug Resolution" }
    },
    {
      "source": { "schema": "dbo", "table": "Bug Version" },
      "destination": { "table": "Bug Version" }
    },
    {
      "source": { "schema": "dbo", "table": "Bug Version Bridge" },
      "destination": { "table": "Bug Version Bridge" }
    },
    {
      "source": { "schema": "dbo", "table": "Bug Version Bridge" },
      "destination": { "table": "Bug Version Bridge" },
      "copySource": {
          "sqlReaderQuery": null
      }
    },
    {
      "source": { "schema": "dbo", "table": "dim_business_unit" },
      "destination": { "table": "Business Unit" }
    },
    {
      "source": { "schema": "dbo", "table": "Campaign" },
      "destination": { "table": "Campaign" }
    },
    {
      "source": { "schema": "dbo", "table": "Company" },
      "destination": { "table": "Company" }
    },
    {
      "source": { "schema": "dbo", "table": "Country" },
      "destination": { "table": "Country" }
    },
    {
      "source": { "schema": "dbo", "table": "dim_currency" },
      "destination": { "table": "Currency" }
    },
    {
      "source": { "schema": "dbo", "table": "dim_currency_rate" },
      "destination": { "table": "Currency Table" }
    },
    {
      "source": { "schema": "dbo", "table": "Customer" },
      "destination": { "table": "Customer" }
    },
    {
      "source": { "table": "dim_date" },
      "destination": { "table": "Date" },
      "copySource": { "sqlReaderQuery": null },
      "copyActivity": {
        "translator": {
          "type": "TabularTranslator",
          "typeConversion": true,
          "typeConversionSettings": {
            "allowDataTruncation": true,
            "treatBooleanAsNumber": false
          }
        }
      }
    },
    {
      "source": { "table": "dim_date" },
      "destination": { "table": "Date Age" },
      "copySource": { "sqlReaderQuery": "SELECT dim_date.date_value AS Date,\nDATEDIFF(DAY, dim_date.date_value, CAST(GETUTCDATE() AT TIME ZONE 'UTC' AT TIME ZONE tz.name AS DATETIME)) AS [Age in Days],      \nDATEDIFF(MONTH, dim_date.date_value, CAST(GETUTCDATE() AT TIME ZONE 'UTC' AT TIME ZONE tz.name AS DATETIME)) AS [Age in Months], \nDATEDIFF(QUARTER, dim_date.date_value, CAST(GETUTCDATE() AT TIME ZONE 'UTC' AT TIME ZONE tz.name AS DATETIME)) AS [Age in Quarters],      \nDATEDIFF(YEAR, dim_date.date_value, CAST(GETUTCDATE() AT TIME ZONE 'UTC' AT TIME ZONE tz.name AS DATETIME)) AS [Age in Years], \ntz.name AS time_zone  \nFROM \ndbo.dim_date\n CROSS APPLY (SELECT DISTINCT TimeZone_Name AS name FROM mdm.Employee WHERE TimeZone_Name IS NOT NULL) AS tz"},
      "copyActivity": {
        "translator": {
          "type": "TabularTranslator",
          "typeConversion": true,
          "typeConversionSettings": {
            "allowDataTruncation": true,
            "treatBooleanAsNumber": false
          }
        }
      }
    },
    {
      "source": { "schema": "dbo", "table": "DirectSalesSums_byPO_forPBI" },
      "destination": { "table": "Direct Sales Sums for Dist Rec PBI" }
    },
    {
      "source": { "schema": "dbo", "table": "Distributor" },
      "destination": { "table": "Distributor" }
    },
    {
      "source": { "schema": "dbo", "table": "Distributor Reconciliation File" },
      "destination": { "table": "Distributor Reconciliation File" }
    },
    {
      "source": { "schema": "dbo", "table": "Distributor Reconciliation Matched" },
      "destination": { "table": "Distributor Reconciliation Matched" }
    },
    {
      "source": { "schema": "dbo", "table": "Edition" },
      "destination": { "table": "Edition" }
    },
    {
      "source": { "table": "mdm.Employee" },
      "destination": { "table": "Employee" },
      "copySource": { "sqlReaderQuery": "SELECT Email, COALESCE(TimeZone_Name, \'Pacific Standard Time\') AS TimeZone, N\'SEANET\\\' + SUBSTRING(Email, 0, CHARINDEX(\'@\', Email, 1)) AS DomainName FROM mdm.Employee" },
      "copyActivity": {
        "translator": {
          "type": "TabularTranslator",
          "typeConversion": true,
          "typeConversionSettings": {
            "allowDataTruncation": true,
            "treatBooleanAsNumber": false
          }
        }
      }
    }
  ]